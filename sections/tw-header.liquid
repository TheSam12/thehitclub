{% liquid
  assign logo_black = section.settings.logo_black
  assign logo_white = section.settings.logo_white
  assign menu = section.settings.menu
  assign icon = section.settings.icon
%}

<div
  id="{{ section.id }}"
  class=" {% if request.page_type == 'index' or page.template_suffix == 'hati' or page.template_suffix == 'gati' or page.template_suffix == 'about-us' or page.template_suffix == 'playlists' %}-tw-mb-28{% endif %}"
>
  <div
    :class="{ 'tw-bg-white tw-drop-shadow-md': scrollPosition >= 1, 'tw-bg-gradient-to-b tw-from-black/50 tw-to-transparent': scrollPosition < 1 }"
  >
    <nav class="tw-container tw-relative tw-m-auto tw-py-8">
      <div class="tw-mx-4 tw-flex tw-items-center tw-justify-between">
        <div class="tw-flex tw-w-full tw-justify-center md:tw-block md:tw-w-fit">
          {% if logo_black != blank %}
            <a href="/" :class="{ 'tw-hidden': scrollPosition < 1 }">
              {{ logo_black | image_url: width: 200 | image_tag }}
            </a>
          {% endif %}
          {% if logo_white != blank %}
            <a href="/" :class="{ 'tw-hidden': scrollPosition >= 1 }">
              {{ logo_white | image_url: width: 200 | image_tag }}
            </a>
          {% endif %}
        </div>
        <div class="relative tw-flex tw-items-center tw-gap-8">
          <div class="tw-hidden tw-gap-4 md:tw-flex">
            {% for link in menu.links %}
              <ul>
                <li>
                  <a
                    href="{{ link.url }}"
                    :class="{ 'tw-text-black': scrollPosition >= 1, 'tw-text-white': scrollPosition < 1 }"
                    class="tw-group tw-peer tw-text-base tw-capitalize"
                  >
                    {{ link.title }}
                  </a>
                  {% for child_link in link.links %}
                    <div class="tw--left-px tw-group-hover:visible tw-group-hover:opacity-100 tw-shadow-ln tw-rounded-b-cl tw-invisible tw-absolute tw-z-20 tw-w-[100%] tw-overflow-hidden tw-font-bold tw-opacity-0 tw-transition-all tw-duration-300 tw-ease-in-out">
                      <p>{{ child_link.title }}</p>
                    </div>
                  {% endfor %}
                </li>
              </ul>
            {% endfor %}
          </div>
          <div class="tw-flex tw-items-center tw-gap-4">
            <div class="tw-hidden md:tw-block">
              <a
                href="{{ routes.cart_url }}"
                class="tw-relative"
                :class="{ 'tw-fill-black': scrollPosition >= 1, 'tw-fill-white': scrollPosition < 1 }"
                aria-haspopup="dialog"
                role="button"
              >
                {% if icon %}
                  {% render 'tw-icon-cart' %}
                {% else %}
                  <span :class="{ 'tw-text-black': scrollPosition >= 1, 'tw-text-white': scrollPosition < 1 }"
                    >Cart</span
                  >
                {% endif %}
                {% if cart != empty %}
                  {% if cart.item_count < 100 %}
                    <span
                      class="tw-absolute tw--right-1 tw--top-1 tw-h-5 tw-h-max tw-w-5 tw-rounded-full tw-text-center tw-text-sm"
                      :class="{ 'tw-text-black': scrollPosition >= 1, 'tw-text-white': scrollPosition < 1,'tw-bg-white': scrollPosition >= 1,'tw-border': scrollPosition >= 1, 'tw-border-black': scrollPosition >= 1, 'tw-bg-black': scrollPosition < 1 }"
                    >
                      {{- cart.item_count -}}
                    </span>
                  {% endif %}
                {% endif %}
              </a>
            </div>
            {% if shop.customer_accounts_enabled %}
              <div class="tw-hidden md:tw-block">
                <a
                  href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.acount_login_url }}{% endif %}"
                  :class="{ 'tw-fill-black': scrollPosition >= 1, 'tw-fill-white': scrollPosition < 1 }"
                >
                  {% if icon %}
                    {% render 'tw-icon-account' %}
                  {% else %}
                    {% if customer %}
                      <span :class="{ 'tw-text-black': scrollPosition >= 1, 'tw-text-white': scrollPosition < 1 }"
                        >Account</span
                      >
                    {% else %}
                      <span :class="{ 'tw-text-black': scrollPosition >= 1, 'tw-text-white': scrollPosition < 1 }"
                        >Login</span
                      >
                    {% endif %}
                  {% endif %}
                </a>
              </div>
            {% endif %}
            <div class="tw-absolute tw-right-5 md:tw-hidden ">
              <button @click="toggleMenu">
                <span
                  v-if="!isMenuOpen"
                  :class="{ 'tw-fill-black': scrollPosition >= 1, 'tw-fill-white': scrollPosition < 1 }"
                >
                  {% render 'tw-icon-hamburger' %}
                </span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </nav>
  </div>
  <div id="mobileMenu" class="tw-invisible tw-transition-all tw-duration-500 tw-ease-in-out">
    <nav
      id="mobileNav"
      class="tw-absolute -tw-left-[480px] tw-top-0 tw-z-20 tw-h-screen tw-w-screen tw-overflow-auto tw-bg-white tw-transition-all tw-duration-500 tw-ease-in-out"
    >
      <div class="tw-flex tw-justify-center tw-p-8">
        <div>
          {% if logo_black != blank %}
            <a href="/">
              {{ logo_black | image_url: width: 200 | image_tag }}
            </a>
          {% endif %}
        </div>
        <div class="tw-absolute  tw-right-5">
          <button @click="toggleMenu">
            <span class="tw-text-xl tw-font-bold">âœ•</span>
          </button>
        </div>
      </div>
      <ul>
        {% for link in menu.links %}
          {% if link != null %}
            <li class="{% if forloop.first %}tw-border-t-1{% else %}tw-border-t-0{% endif %} tw-border-b-1 tw-border tw-border-x-0 tw-px-5 tw-py-4">
              <a
                href="{{ link.url }}"
                class="tw-group tw-peer tw-text-base tw-capitalize"
              >
                {{ link.title }}
              </a>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </nav>
  </div>
</div>
<script>
  var { createApp } = Vue;
  const appHeader = createApp({
    delimiters: ['${', '}'],
    data() {
      const scrollPosition = 0;
      return {
        scrollPosition,
        isMenuOpen: false,
      };
    },
    methods: {
      updateScroll() {
        this.scrollPosition = window.scrollY;
      },
      toggleMenu() {
        this.isMenuOpen = !this.isMenuOpen;
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileNav = document.getElementById('mobileNav');
        if (this.isMenuOpen) {
          mobileMenu.classList.remove('tw-invisible');
          mobileMenu.classList.add('tw-visible');
          mobileNav.classList.remove('-tw-left-[480px]');
          mobileNav.classList.add('-tw-left-0');
        } else {
          mobileMenu.classList.add('tw-invisible');
          mobileMenu.classList.remove('tw-visible');
          mobileNav.classList.remove('-tw-left-0');
          mobileNav.classList.add('-tw-left-[480px]');
        }
      },
    },
    mounted() {
      // Add scroll event listener
      window.addEventListener('scroll', this.updateScroll);
    },
  });
  appHeader.mount('#{{ section.id }}');
</script>

<style>
  .change-color {
    background-color: #fff !important;
  }
</style>

{% schema %}
{
  "name": "Custom header",
  "class": "tw-sticky tw-top-0 tw-z-10",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo_black",
      "label": "Dark Logo"
    },
    {
      "type": "image_picker",
      "id": "logo_white",
      "label": "Light Logo"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu"
    },
    {
      "type": "checkbox",
      "id": "icon",
      "label": "Show Icons",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Custom header"
    }
  ]
}
{% endschema %}
